import{u as k,a as q,b as y,c as R,r as h,j as e,I as $,s as A,d as F}from"./index-d4ed2424.js";import{L as P,A as E,v as d}from"./LocaleSelect-2c8ad3a2.js";import{u as V,t as o}from"./Toast-1e202ccb.js";const m={minLength:4,maxLength:320,noSpace:!0,noChinese:!0},O=()=>{const{t:s}=k(),x=q(),u=y(),p=R(),r=V(!1),{appearance:N,locale:v,systemStatus:a}=u.state,f=a.profile.mode,[i,w]=h.useState(f==="dev"?"demohero":""),[c,L]=h.useState(f==="dev"?"secret":"");h.useEffect(()=>{p.doSignOut().catch()},[]);const C=n=>{const t=n.target.value;w(t)},S=n=>{const t=n.target.value;L(t)},b=n=>{u.setLocale(n)},I=n=>{u.setAppearance(n)},U=async()=>{if(r.isLoading)return;const n=d(i,m);if(!n.result){o.error(s("common.username")+": "+s(n.reason));return}const t=d(c,m);if(!t.result){o.error(s("common.password")+": "+s(t.reason));return}try{r.setLoading(),await A(i,c),await p.doSignIn()?x("/"):o.error(s("message.login-failed"))}catch(l){console.error(l),o.error(l.response.data.error)}r.setFinish()},j=async n=>{if(r.isLoading)return;const t=d(i,m);if(!t.result){o.error(s("common.username")+": "+s(t.reason));return}const l=d(c,m);if(!l.result){o.error(s("common.password")+": "+s(l.reason));return}try{r.setLoading(),await F(i,c,n),await p.doSignIn()?x("/"):o.error(s("common.singup-failed"))}catch(g){console.error(g),o.error(g.response.data.error)}r.setFinish()};return e.jsx("div",{className:"page-wrapper auth",children:e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"auth-form-wrapper",children:[e.jsxs("div",{className:"page-header-container",children:[e.jsxs("div",{className:"title-container",children:[e.jsx("img",{className:"logo-img",src:a.customizedProfile.logoUrl,alt:""}),e.jsx("p",{className:"logo-text",children:a.customizedProfile.name})]}),e.jsx("p",{className:"slogan-text",children:a.customizedProfile.description||s("slogan")})]}),e.jsxs("div",{className:`page-content-container ${r.isLoading?"requesting":""}`,children:[e.jsxs("div",{className:"form-item-container input-form-container",children:[e.jsx("span",{className:`normal-text ${i?"not-null":""}`,children:s("common.username")}),e.jsx("input",{className:"input-text",type:"text",value:i,onChange:C,required:!0})]}),e.jsxs("div",{className:"form-item-container input-form-container",children:[e.jsx("span",{className:`normal-text ${c?"not-null":""}`,children:s("common.password")}),e.jsx("input",{className:"input-text",type:"password",value:c,onChange:S,required:!0})]})]}),e.jsx("div",{className:"action-btns-container",children:a!=null&&a.host?e.jsxs(e.Fragment,{children:[r.isLoading&&e.jsx($.Loader,{className:"w-4 h-auto mr-2 animate-spin dark:text-gray-300"}),(a==null?void 0:a.allowSignUp)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`btn-text ${r.isLoading?"requesting":""}`,onClick:()=>j("USER"),children:s("common.sign-up")}),e.jsx("span",{className:"mr-2 font-mono text-gray-200",children:"/"})]}),e.jsx("button",{className:`btn-primary ${r.isLoading?"requesting":""}`,onClick:U,children:s("common.sign-in")})]}):e.jsx(e.Fragment,{children:e.jsx("button",{className:`btn-primary ${r.isLoading?"requesting":""}`,onClick:()=>j("HOST"),children:s("auth.signup-as-host")})})}),!(a!=null&&a.host)&&e.jsx("p",{className:"tip-text",children:s("auth.host-tip")})]}),e.jsxs("div",{className:"flex flex-row items-center justify-center w-full gap-2",children:[e.jsx(P,{value:v,onChange:b}),e.jsx(E,{value:N,onChange:I})]})]})})};export{O as default};
